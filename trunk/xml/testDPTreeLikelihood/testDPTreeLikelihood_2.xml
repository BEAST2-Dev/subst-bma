<beast version='2.0'
       namespace='beast.core:beast.evolution.tree.coalescent:beast.core.util:beast.evolution.nuc:beast.evolution.operators:beast.evolution.sitemodel:beast.evolution.substitutionmodel:beast.evolution.likelihood:beast.evolution.branchratemodel:beast.core.parameter:beast.math.distributions'>


    <!-- The sequence alignment                                                  -->
    <!-- ntax=6 nchar=768                                                        -->
    <!-- npatterns=69                                                            -->
    <data id="alignment" dataType="nucleotide">
        <sequence taxon="human">
            AGAAATATGTCTGATAAAAGAGTTACTTTGATAGAGTAAATAATAGGAGCTTAAACCCCCTTATTTCTACTAGGACTATGAGAATCGAAC
        </sequence>
        <sequence taxon="chimp">
            AGAAATATGTCTGATAAAAGAATTACTTTGATAGAGTAAATAATAGGAGTTCAAATCCCCTTATTTCTACTAGGACTATAAGAATCGAAC
        </sequence>
        <sequence taxon="bonobo">
            AGAAATATGTCTGATAAAAGAATTACTTTGATAGAGTAAATAATAGGAGTTTAAATCCCCTTATTTCTACTAGGACTATGAGAGTCGAAC
        </sequence>
        <sequence taxon="gorilla">
            AGAAATATGTCTGATAAAAGAGTTACTTTGATAGAGTAAATAATAGAGGTTTAAACCCCCTTATTTCTACTAGGACTATGAGAATTGAAC
        </sequence>
        <sequence taxon="orangutan">
            AGAAATATGTCTGACAAAAGAGTTACTTTGATAGAGTAAAAAATAGAGGTCTAAATCCCCTTATTTCTACTAGGACTATGGGAATTGAAC
        </sequence>
        <sequence taxon="siamang">
            AGAAATACGTCTGACGAAAGAGTTACTTTGATAGAGTAAATAACAGGGGTTTAAATCCCCTTATTTCTACTAGAACCATAGGAGTCGAAC
        </sequence>
    </data>

    <input spec="ParameterList" id="parameterList">
        <parameter spec="RealParameter2" id="parameter1" value="1" upper="Infinity" lower="-Infinity"/>
    </input>

    <input spec="DPPointer" id="pointers">
        <input name="uniqueParameter" idref="parameter1"/>
        <input name="initialAssignment" spec="IntegerParameter" value="0" dimension="768" lower="0" upper="768"/>
    </input>

    <input spec="DPSiteModelOld" id="spSiteModel">
        <input name="pointers" idref="pointers"/>
        <input name="paramList" idref="parameterList"/>
    </input>

    <input spec="StrictClockModel" id="strict.clock">
        <input name="clock.rate" spec="RealParameter" id="mu" value="1.0" lower="0.0"/>
    </input>

    <input spec='DPTreeLikelihood' id="treeLikelihood">
        <data idref="alignment"/>
        <tree idref="tree"/>
        <dpSiteModelOld idref="spSiteModel"/>
        <branchRateModel idref="strict.clock"/>
    </input>

    <input spec="DPValuable" id="dpValuable">
        <input spec="ParameterList" name="paramList" idref="parameterList"/>
        <input spec="DPPointer" name="pointers" idref="pointers"/>
    </input>

    <input spec="DirichletProcess" id="dp">
        <input name="dpVal" idref="dpValuable"/>
        <input name="baseDistr" spec="beast.math.distributions.Gamma" id="base" alpha="10" beta="0.1" />
        <input name="alpha" spec="RealParameter" value="1.0" lower="0.0" upper="Infinity"/>
    </input>


    <tree spec='beast.util.ClusterTree' id='tree' clusterType='upgma'>
        <taxa idref='alignment'/>
    </tree>


    <run spec="MCMC" id="mcmc" chainLength="1000000">
        <state storeEvery='100'>
            <stateNode idref="parameterList"/>
            <stateNode idref="pointers"/>
            <stateNode idref="tree"/>
        </state>



        <operator id='treeScaler' spec='ScaleOperator' scaleFactor="0.5" weight="1" tree="@tree"/>
        <operator spec='Uniform' weight="10" tree="@tree"/>
        <operator spec='SubtreeSlide' weight="5" gaussian="true" size="1.0" tree="@tree"/>
        <operator id='narrow' spec='Exchange' isNarrow='true' weight="1" tree="@tree"/>
        <operator id='wide' spec='Exchange' isNarrow='false' weight="1" tree="@tree"/>
        <operator spec='WilsonBalding' weight="1" tree="@tree"/>

        <distribution spec="CompoundDistribution" id="posterior">
            <distribution idref="treeLikelihood"/>
            <distribution id="prior" spec="beast.math.distributions.ParameterListPrior" applyToList="true">
                <input name="distribution" idref="dp"/>
                <xList idref="parameterList"/>
            </distribution>
        </distribution>

        <operator id="dpps" spec="DirichletProcessPriorGibbsSampler" weight="1" sampleSize="1">
            <input name='likelihood' idref="treeLikelihood"/>
            <input name="xList" idref="parameterList"/>
            <input name="pointers" idref="pointers"/>
            <input name="dirichletProcess" idref="dp"/>
            <input name="dpVal" idref="dpValuable"/>
        </operator>
        <operator id="errwo" spec="PLExtendedRealRandomWalkOperator" windowSize="0.1" weight="1">
            <input name="parameters" idref="parameterList"/>
        </operator>


        <logger logEvery="1000" fileName="testDPLikelihood2.log">
	        <model idref='treeLikelihood'/>
            <log idref="treeLikelihood"/>
            <log idref="prior"/>
            <log idref="dpValuable"/>
            <log idref="parameterList"/>
            <log idref="pointers"/>
            <log spec='beast.evolution.tree.TreeHeightLogger' tree='@tree'/>
        </logger>
        <logger logEvery="1000" fileName="testDPLikelihood1.trees">
            <log idref="tree"/>
        </logger>
        <logger logEvery="100000">
	        <model idref='treeLikelihood'/>
            <log idref="treeLikelihood"/>
    	    <ESS spec='ESS' name='log' arg="@treeLikelihood"/>
            <log idref="prior"/>
            <log idref="dpValuable"/>
            <log idref="parameterList"/>
            <log idref="pointers"/>
        </logger>
    </run>

</beast>
