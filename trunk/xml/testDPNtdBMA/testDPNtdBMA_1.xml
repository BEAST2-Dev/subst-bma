<beast version='2.0'
       namespace='beast.core:beast.evolution.tree.coalescent:beast.core.util:beast.evolution.nuc:beast.evolution.operators:beast.evolution.sitemodel:beast.evolution.substitutionmodel:beast.evolution.branchratemodel:beast.evolution.likelihood:beast.core.parameter:beast.math.distributions'>

    <input spec="ParameterList" id="parameterList">
        <parameter spec="RealParameter" id="parameter1" value="0.0 0.0 0.0 0.0 0.0 0.0" upper="Infinity" lower="-Infinity"/>
    </input>

    <input spec="DPPointer" id="param.pointers">
        <input name="uniqueParameter" idref="parameter1"/>
        <input name="initialAssignment" spec="IntegerParameter" value="0 0 0" lower="0"/>
    </input>

    <input spec="ParameterList" id="modelList">
        <parameter spec="RealParameter" id="parameter2" value="2.0" upper="5.0" lower="0.0"/>
    </input>

    <input spec="DPPointer" id="model.pointers">
        <input name="uniqueParameter" idref="parameter2"/>
        <input name="initialAssignment" spec="IntegerParameter" value="0 0 0" lower="0"/>
    </input>

    <input spec="ParameterList" id="freqList">
        <parameter spec="RealParameter" id="parameter3" value="0.25 0.25 0.25 0.25" upper="1.0" lower="0.0"/>
    </input>

    <input spec="DPPointer" id="freq.pointers">
        <input name="uniqueParameter" idref="parameter3"/>
        <input name="initialAssignment" spec="IntegerParameter" value="0 0 0" lower="0"/>
    </input>


    <input spec="DPNtdBMA" id="dpNtdBMA">
        <input name="paramList" spec="ParameterList" idref="parameterList"/>
        <input name="modelList" spec="ParameterList" idref="modelList"/>
        <input name="freqList" spec="ParameterList" idref="freqList"/>
        <input name="paramPointers" spec="DPPointer" idref="param.pointers"/>
        <input name="modelPointers" spec="DPPointer" idref="model.pointers"/>
        <input name="freqPointers" spec="DPPointer" idref="freq.pointers"/>
    </input>


    <input spec="DummyLikelihood" id="likelihood">
        <input name="plugin" spec="DPNtdBMA" idref="dpNtdBMA"/>
    </input>

    <input spec="DPValuable" id="dpValuable">
        <input spec="ParameterList" name="paramList" idref="freqList"/>
        <input spec="DPPointer" name="pointers" idref="freq.pointers"/>
    </input>

    <input spec="NtdDP" id="ntddp">
        <input name="dpVal" idref="dpValuable"/>
        <input name="paramBaseDistr" spec="beast.math.distributions.MultivariateNormal">
            <input name="mean" spec="RealParameter" value="0 0 0 0 0 0"/>
            <input name="precision" spec="MatrixParameter">
                <parameter value="1.0 0 0 0 0 0"/>
                <parameter value="0 1.0 0 0 0 0"/>
                <parameter value="0 0 1.0 0 0 0"/>
                <parameter value="0 0 0 1.0 0 0"/>
                <parameter value="0 0 0 0 1.0 0"/>
                <parameter value="0 0 0 0 0 1.0"/>
            </input>
        </input>
        <input name="modelBaseDistr" spec="beast.math.distributions.IntegerUniformDistribution" lower="0.0" upper="5.0"/>
        <input name="freqBaseDistr" spec="beast.math.distributions.DirichletDistribution">
            <input name="alpha" spec="RealParameter" value="1.0 1.0 1.0 1.0" lower="0" upper="1.0"/>
        </input>
        <input name="alpha" spec="RealParameter" value="1.0" lower="0.0" upper="Infinity"/>
    </input>

    <input spec="Count" id="model.count">
        <input name="list" idref="dpNtdBMA"/>
    </input>


    <run spec="MCMC" id="mcmc" chainLength="100"> <!--autoOptimize="true"-->
        <state>
            <input name='stateNode' idref='parameterList'/>
            <input name='stateNode' idref='modelList'/>
            <input name='stateNode' idref='freqList'/>
            <input name='stateNode' idref='param.pointers'/>
            <input name='stateNode' idref='model.pointers'/>
            <input name='stateNode' idref='freq.pointers'/>
        </state>

        <distribution spec="CompoundDistribution" id="posterior">
            <distribution idref="likelihood"/>
            <!--distribution id="prior" spec="beast.math.distributions.ParameterListPrior" applyToList="true">
                <input name="distribution" idref="dp"/>
                <xList idref="parameterList"/>
            </distribution-->
        </distribution>

        <operator id="dpps" spec="NtdBMADPPGibbsSampler" weight="1" sampleSize="1">
            <input name="likelihood" idref="likelihood"/>
            <input name="parameterList" idref="parameterList"/>
            <input name="parameterPointers" idref="param.pointers"/>
            <input name="modelList" idref="modelList"/>
            <input name="modelPointers" idref="model.pointers"/>
            <input name="freqList" idref="freqList"/>
            <input name="freqPointers" idref="freq.pointers"/>
            <input name="dirichletProcess" idref="ntddp"/>
            <input name="dpVal" idref="dpValuable"/>
        </operator>

        <logger logEvery="10">
            <log idref="posterior"/>
            <log idref="likelihood"/>
            <log idref="dpValuable"/>
            <log idref="model.count"/>
            <!--log idref="param.pointers"/>
            <log idref="model.pointers"/>
            <log idref="freq.pointers"/-->
        </logger>


        <logger logEvery="10" fileName="testDPNtdBMA_1.log">
            <log idref="dpValuable"/>
            <log idref="param.pointers"/>
            <log idref="model.pointers"/>
            <log idref="freq.pointers"/>
        </logger>
    </run>
</beast>